<br>
<%= link_to 'New Venue', new_venue_path %>
<div class ="row">
  <div class='col-md-3'>
    <div class="row">
      <%= render 'search' %>  
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">There are <%= @venues.length %> Venues <%= @search_place %></h3>
        </div>
        <div class="panel-body">
          <div class="resultcontainer">
                <% @venues.each do |venue| %>
                  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <div class="thumbnail">
                      <img data-src="#" alt="">
                      <div class="caption">
                        <h3><%= venue.name %></h3>
                        <ul>
                          <li> <%= venue.free_wifi %></li>
                          <li> <%= venue.charging %> </li>
                          <li> <%= venue.website %> </li>
                          <li> <%= venue.address %> </li>
                          <li> <%= venue.address_line_2 %> </li>
                          <li> <%= venue.postcode %> </li>
                        </ul>
                          <%= link_to "Go To Venue Details Page", venue_path(venue.id), class: "btn btn-default" %>
                          <button type="button" class="btn btn-default" onClick="centerMap(<%= venue.longitude %>,<%= venue.latitude %>,handler)">Center on Venue</button>
                      </div>
                    </div>
                  </div>
                <% end %>
              </div>

        </div>
    </div>
  </div>
  <div class="col-md-9"><div class ='gmap'>
      <div id='gmapuniq'></div>
  </div>
  </div>
</div>
<script>
$(document).ready(function(){
  // var geocoder;
  handler = Gmaps.build('Google');
  geocoder = new google.maps.Geocoder();
  handler.buildMap({ provider: {}, internal: {id: 'gmapuniq'}}, function(){
  markers = handler.addMarkers(<%= raw @hash.to_json %>);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
  console.log("something");
});


});
  // function codeAddress(){
  //   var geocoder
  //   geocoder = new google.maps.Geocoder();
  //   var address = document.getElementById('location-input').value;
  //   geocoder.geocode({'address': address}, function(results,status){
  //     if (status == google.maps.GeoCoderStatus.OK){
  //       handler.setCenter(results[0].geometry.location);
  //     } else {
  //       alert('geocode was not successful for the following reason'+ status)
  //     }

  //   });

  // };

  function centerMap(longitude, latitude, handler){ 
    // handler.panTo({lat: 22, lng: 32});
    console.log(longitude);
    console.log(latitude);


    handler.map.centerOn(new google.maps.LatLng(latitude, longitude));
    console.log("calling the centermap function");
    handler.buildMap({ provider: {zoom: 16}, internal: {id: 'gmapuniq'}}, function(){
       markers = handler.addMarkers(<%= raw @hash.to_json %>);
       handler.map.centerOn(new google.maps.LatLng(latitude, longitude));
    });

  }

  function codeAddress() {
    // var geocoder
    // geocoder = new google.maps.Geocoder();
    console.log(handler);
    // handler = Gmaps.build('Google');
    var address = document.getElementById('location-input').value;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        console.log(results);
        handler.getMap().setCenter(results[0].geometry.location);
        // var marker = new google.maps.Marker({
        //     map: handler.getMap(),
        //     position: results[0].geometry.location
        // });
      } else {
        alert('Geocode was not successful for the following reason: ' + status);
      }
    });
  }

  function autoComplete(){
    var query = document.getElementById('location-input').value;
    geocoder.geocode({'address': query}, function(results, status){
      if (status == google.maps.GeocoderStatus.OK){
        choices = [];
        for (var i = results.length - 1; i >= 0; i--) {
          choices.push(results[i].formatted_address);
        };
        console.log(choices);
        trial = ["one","two","three"];
        console.log(trial);
        // completebox = document.getElementById("location-input");
        completebox = $('#location-input');
        // completebox.autocomplete("enable");
        completebox.autocomplete({source: choices});
        console.log('choices');      
        // completebox.autocomplete({source: trial});
      }
    })

  }

</script>
<!-- <h2><%= @hash %></h2> -->

